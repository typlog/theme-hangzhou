{%- set column = note.column -%}
{%- set columns = query.filter_columns(type=column.type, lang=column.lang) -%}

{%- if column.metadata.config -%}
{% set column_config = query.parse_asset_data(column.metadata.config) %}
{%- else -%}
{% set column_config = None %}
{%- endif -%}

{% set alternates = query.alternate_notes(slug=note.slug) %}

{% block extra_meta %}
  {% for item in alternates %}
    {% if item.id != note.id -%}
      <link rel="alternate" hreflang="{{ item.lang }}" href="{{ item.url }}" />
    {% endif %}
  {% endfor %}
{% endblock -%}

{% block styles %}
{% include "./_partials/webfonts.j2" %}
<link rel="stylesheet" href="{{ _static_url }}/base.css">
<link rel="stylesheet" href="{{ _static_url }}/docs.css">
{% include "components/clipboard-copy.j2" %}
<style>:root{--navbar-height: 112px}</style>
{% if columns|count < 2 %}
  <style>@media (width >= 64rem){ :root {--navbar-height: 64px} }</style>
{% endif %}
{% endblock %}

{% block scripts %}
<script src="{{ _static_url }}/app.js" type="module" async></script>
{% include "components/iconify-icon.j2" %}
{% include "components/lightbox.j2" %}
{% endblock %}

{% block body %}
  <div id="navbar" class="z-30 fixed lg:sticky top-0 w-full">
    <div id="navbar-backdrop"></div>
    <div class="mx-auto max-w-content relative">
      {% include "./_layouts/components/nav-head.j2" %}
      {% include "./_layouts/components/nav-breadcrumbs.j2" %}
      {% include "./_layouts/components/nav-columns.j2" %}
    </div>
  </div>
  <main id="main" class="max-w-content flex mx-auto pt-28 lg:pt-0 lg:px-8">
    {% include "./_layouts/doc-sidebar.j2" %}
    <div id="content-container" class="grow overflow-x-hidden px-6">
      <article class="relative min-w-0 pt-8">
        <div class="mb-2 uppercase text-sm font-semibold text-accent-10">{{ column.title }}</div>
        <h1 class="p-name text-2xl lg:text-4xl font-bold">{{ note.title }}</h1>
        {% if note.subtitle %}
          <h2 class="p-summary mt-2 text-lg text-gray-11">{{ note.subtitle }}</h2>
        {% endif %}
        <div class="e-content font-serif lg:text-lg">
          {{ note.content }}
        </div>
        <div class="flex justify-between pb-12">
          <div class="entry-tags flex items-center gap-4">
            {% for tag in note.tags %}
              <a class="p-category" href="{{ tag.url }}">{{ tag.title }}</a>
            {% endfor %}
          </div>
          <div class="text-xs text-gray-10 flex items-center">
            <span>{{ translate('last_updated') }}</span>
            <time class="js-time" datetime="{{ note.updated_at|xmldatetime }}">{{ note.updated_at|dateformat('%b %d, %Y') }}</time>
          </div>
        </div>
      </article>
    </div>
    <div class="hidden xl:block">
      <aside id="aside" class="pl-6 pt-8 w-64 sticky top-(--navbar-height) overflow-y-auto">
        {% if alternates|count > 1 %}
          <div class="flex items-center gap-1 text-sm mb-2">
            <iconify-icon icon="lucide:languages"></iconify-icon>
            <span class="font-medium">{{ translate('otherlang') }}</span>
          </div>
          <div class="flex flex-col gap-0.5 mb-8">
            {% for item in alternates %}
              {% if item.id != note.id -%}
                <a href="{{ item.url }}" data-lang="{{ item.lang }}">{{ translate(item.lang) }}</a>
              {% endif %}
            {% endfor %}
          </div>
        {% endif %}
        <div class="flex items-center gap-1 text-sm mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M8 6h10"/>
            <path d="M6 12h9"/>
            <path d="M11 18h7"/>
          </svg>
          <span class="font-medium">{{ translate('onthispage') }}</span>
        </div>
        <div class="js-outline outline-content">
          <div class="outline-marker"></div>
        </div>
      </aside>
    </div>
  </main>
  {% include "./_layouts/footer.j2" %}
{% endblock %}
